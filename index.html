<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Tennis Skills Evaluation</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 40px auto; }
    .question { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: bold; }
    select { width: 100px; padding: 6px; }
    button { padding: 10px 20px; margin-top: 20px; }
  </style>
</head>
<body>

  <h1>Tennis Skills Evaluation</h1>

  <form id="surveyForm">
    <div class="question">
      <label>Name</label>
      <input type="text" name="name" required placeholder="Enter your name">
    </div>

    <script>
      const questions = [
        "Forehand",
        "Backhand",
        "Volleys",
        "Serve",
        "Return of Serve",
        "Footwork",
        "Consistency",
        "Power",
        "Tactical Awareness",
        "Overall Tennis Ability"
      ];

      questions.forEach((q, i) => {
        document.write(`
          <div class="question">
            <label>${i+1}. ${q}</label>
            <select name="q${i+1}" required>
              <option value="">--</option>
              ${Array.from({length:10}, (_,n)=>`<option value="${n+1}">${n+1}</option>`).join("")}
            </select>
          </div>
        `);
      });
    </script>

    <button type="button" onclick="submitSurvey()">Submit</button>
  </form>

  <h2 id="result"></h2>

  <script>
    function submitSurvey() {
      const form = document.getElementById("surveyForm");
      const data = new FormData(form);

      let total = 0;
      for (let i = 1; i <= 10; i++) {
        total += Number(data.get("q" + i));
      }

      const payload = {
        name: data.get("name"),
        q1: data.get("q1"),
        q2: data.get("q2"),
        q3: data.get("q3"),
        q4: data.get("q4"),
        q5: data.get("q5"),
        q6: data.get("q6"),
        q7: data.get("q7"),
        q8: data.get("q8"),
        q9: data.get("q9"),
        total: total
      };

      fetch("https://script.google.com/macros/s/AKfycbxAEpzQMs9hGo_qDjVIfNUMrCGqXCl_Uj-sdMnkiIj6uZqPipFDQNScpFwWtwufMZmh/exec", {
        method: "POST",
        body: JSON.stringify(payload)
      })
      .then(() => {
        document.getElementById("result").innerText = "Thank you! Your evaluation has been submitted.";
        form.reset();
      })
      .catch(() => {
        document.getElementById("result").innerText = "Error submitting form.";
      });
    }
  </script>

</body>
</html>
